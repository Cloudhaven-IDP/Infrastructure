version: 3
automerge: true
parallel_plan: true
parallel_apply: true

projects:
  - name: services-devops-atlantis
    dir: services/devops/atlantis
    terraform_version: "1.6.6"
    autoplan:
      enabled: true
      when_modified:
        - "**/*.tf"
        - "**/*.tfvars"
        - "atlantis.yaml"
    workflow: default

  - name: services-devops-argocd-argocd
    dir: services/devops/argocd/argocd
    terraform_version: "1.6.6"
    autoplan:
      enabled: true
      when_modified:
        - "**/*.tf"
        - "**/*.tfvars"
        - "atlantis.yaml"
    workflow: default

  - name: services-devops-cloudflare
    dir: services/devops/cloudflare
    terraform_version: "1.6.6"
    autoplan:
      enabled: true
      when_modified:
        - "**/*.tf"
        - "**/*.tfvars"
        - "atlantis.yaml"
    workflow: default

  - name: services-devops-twingate
    dir: services/devops/twingate
    terraform_version: "1.6.6"
    autoplan:
      enabled: true
      when_modified:
        - "**/*.tf"
        - "**/*.tfvars"
        - "atlantis.yaml"
    workflow: default

  - name: services-devops-aws-vpc
    dir: services/devops/aws/vpc
    terraform_version: "1.6.6"
    autoplan:
      enabled: true
      when_modified:
        - "**/*.tf"
        - "**/*.tfvars"
        - "atlantis.yaml"
    workflow: default

  - name: services-devops-aws-cloudhaven-k8s-1
    dir: services/devops/aws/cloudhaven-k8s-1
    terraform_version: "1.6.6"
    autoplan:
      enabled: true
      when_modified:
        - "**/*.tf"
        - "**/*.tfvars"
        - "atlantis.yaml"
    workflow: default

  - name: services-devops-github-repos
    dir: services/devops/github/repos
    terraform_version: "1.6.6"
    autoplan:
      enabled: true
      when_modified:
        - "**/*.tf"
        - "**/*.tfvars"
        - "atlantis.yaml"
    workflow: default

  - name: services-devops-github-teams
    dir: services/devops/github/teams
    terraform_version: "1.6.6"
    autoplan:
      enabled: true
      when_modified:
        - "**/*.tf"
        - "**/*.tfvars"
        - "atlantis.yaml"
    workflow: default

  - name: services-devops-aws-state
    dir: services/devops/aws/state
    terraform_version: "1.6.6"
    autoplan:
      enabled: true
      when_modified:
        - "**/*.tf"
        - "**/*.tfvars"
        - "atlantis.yaml"
    workflow: default

workflows:
  default:
    plan:
      steps:
        - init
        - plan
    apply:
      steps:
        - apply
